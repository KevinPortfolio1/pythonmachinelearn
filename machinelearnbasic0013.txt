train_test_split() 
æ˜¯ Scikit-learn ä¸­æœ€å¸¸ç”¨çš„å‡½æ•¸ä¹‹ä¸€ï¼Œç”¨ä¾†å°‡è³‡æ–™é›†åˆ†å‰²æˆ è¨“ç·´é›†ï¼ˆtraining setï¼‰ å’Œ æ¸¬è©¦é›†ï¼ˆtesting setï¼‰ï¼Œ
é€™æ¨£å¯ä»¥ç”¨ä¾†è¨“ç·´æ¨¡å‹ä¸¦é©—è­‰å…¶æ³›åŒ–èƒ½åŠ›ã€‚

from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(
    X, y, 
    test_size=0.2,     # æˆ– train_size=0.8
    random_state=42,   # è¨­å®šäº‚æ•¸ç¨®å­ï¼Œä½¿çµæœå¯é‡ç¾
    shuffle=True,      # æ˜¯å¦åœ¨åˆ†å‰²å‰æ‰“äº‚è³‡æ–™
    stratify=y         # åˆ†å±¤æŠ½æ¨£ï¼Œä¿æŒ y çš„é¡åˆ¥åˆ†å¸ƒ
)


| åƒæ•¸             | èªªæ˜                                       |
| -------------- | ---------------------------------------- |
| `X`            | ç‰¹å¾µè³‡æ–™ï¼ˆä¾‹å¦‚ DataFrame æˆ– NumPy é™£åˆ—ï¼‰            |
| `y`            | æ¨™ç±¤è³‡æ–™ï¼ˆä¾‹å¦‚ é¡åˆ¥æ¨™ç±¤æˆ–ç›®æ¨™è®Šæ•¸ï¼‰                       |
| `test_size`    | æ¸¬è©¦è³‡æ–™ä½”å…¨éƒ¨è³‡æ–™çš„æ¯”ä¾‹ï¼ˆ0\~1ä¹‹é–“ï¼‰æˆ–ç›´æ¥çµ¦å®šæ•¸é‡ï¼ˆå¦‚ 100ï¼‰       |
| `train_size`   | è¨“ç·´è³‡æ–™æ¯”ä¾‹ï¼ˆå’Œ test\_size è‡³å°‘æŒ‡å®šä¸€å€‹ï¼‰              |
| `random_state` | éš¨æ©Ÿç¨®å­ï¼Œç¢ºä¿æ¯æ¬¡åˆ†å‰²çµæœä¸€æ¨£                          |
| `shuffle`      | æ˜¯å¦åœ¨åˆ†å‰²å‰å…ˆæ‰“äº‚è³‡æ–™ï¼ˆé è¨­ç‚º `True`ï¼‰                  |
| `stratify`     | ç”¨æ–¼åˆ†é¡ä»»å‹™ï¼šæ ¹æ“š `y` çš„é¡åˆ¥æ¯”ä¾‹ä¾†åˆ†å±¤æŠ½æ¨£ï¼Œé¿å…è¨“ç·´/æ¸¬è©¦è³‡æ–™é¡åˆ¥åˆ†å¸ƒä¸å‡ |


from sklearn.model_selection import train_test_split
from sklearn.datasets import load_iris

# è¼‰å…¥ iris è³‡æ–™é›†
iris = load_iris()
X = iris.data
y = iris.target

# åˆ†å‰²è³‡æ–™é›†ï¼š80%è¨“ç·´ã€20%æ¸¬è©¦ï¼Œä¿ç•™é¡åˆ¥åˆ†å¸ƒ
X_train, X_test, y_train, y_test = train_test_split(
    X, y, 
    test_size=0.2, 
    random_state=1,
    stratify=y
)

print("è¨“ç·´è³‡æ–™ç­†æ•¸ï¼š", len(X_train))
print("æ¸¬è©¦è³‡æ–™ç­†æ•¸ï¼š", len(X_test))


ğŸ“Š ç‚ºä»€éº¼ä½¿ç”¨ train_test_splitï¼Ÿ

æ¨¡å‹è©•ä¼°è¦å®¢è§€ï¼šä¸èƒ½åªç”¨è¨“ç·´è³‡æ–™ä¾†è©•ä¼°æ¨¡å‹æ•ˆèƒ½ï¼Œå¦å‰‡å®¹æ˜“éæ“¬åˆï¼ˆoverfittingï¼‰ã€‚

é¿å…è³‡æ–™æ´©æ¼ï¼ˆdata leakageï¼‰ï¼šè‹¥ä¸æ­£ç¢ºåœ°åˆ†å‰²è³‡æ–™ï¼Œå¯èƒ½æœƒè®“æ¨¡å‹æå‰ã€Œçœ‹è¦‹ã€æ¸¬è©¦è³‡æ–™ã€‚

ä¿æŒé¡åˆ¥åˆ†å¸ƒä¸€è‡´ï¼ˆåˆ†é¡å•é¡Œï¼‰ï¼šä½¿ç”¨ stratify=y å¯ä»¥é˜²æ­¢è¨“ç·´å’Œæ¸¬è©¦é›†ä¸­æŸäº›é¡åˆ¥è¢«æŠ½å¤ªå¤šæˆ–å¤ªå°‘


æ“¬åˆï¼ˆoverfittingï¼‰
ã€Œå°‡è¨“ç·´è³‡æ–™å¸¶å…¥æ¨¡å‹ï¼Œè®“æ¨¡å‹å­¸ç¿’è¼¸å…¥ï¼ˆç‰¹å¾µ Xï¼‰èˆ‡è¼¸å‡ºï¼ˆç›®æ¨™ yï¼‰ä¹‹é–“çš„å°æ‡‰é—œä¿‚ã€‚ã€

| é¡å‹                    | æ“¬åˆçš„ç›®çš„æ˜¯ä»€éº¼ï¼Ÿ            |
| --------------------- | -------------------- |
| **ç›£ç£å¼å­¸ç¿’**             | æ‰¾å‡ºç‰¹å¾µèˆ‡æ¨™ç±¤çš„é—œä¿‚ï¼Œä¾‹å¦‚åˆ†é¡ã€å›æ­¸   |
| **éç›£ç£å¼å­¸ç¿’**            | æ‰¾å‡ºè³‡æ–™ä¸­çš„çµæ§‹ï¼Œä¾‹å¦‚åˆ†ç¾¤ã€é™ç¶­     |
| **éæ“¬åˆï¼ˆOverfittingï¼‰**  | æ¨¡å‹éåº¦è¨˜ä½è¨“ç·´è³‡æ–™ â†’ å°æ–°è³‡æ–™è¡¨ç¾å·® |
| **æ¬ æ“¬åˆï¼ˆUnderfittingï¼‰** | æ¨¡å‹å¤ªç°¡å–®ï¼Œç„¡æ³•æŒæ¡è³‡æ–™çš„è¦å¾‹      |

